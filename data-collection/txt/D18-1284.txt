



















































Learning Personas from Dialogue with Attentive Memory Networks


Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing, pages 2638–2646
Brussels, Belgium, October 31 - November 4, 2018. c©2018 Association for Computational Linguistics

2638

Learning Personas from Dialogue with
Attentive Memory Networks

Eric Chu ∗
MIT Media Lab
echu@mit.edu

Prashanth Vijayaraghavan ∗
MIT Media Lab

pralav@mit.edu

Deb Roy
MIT Media Lab

dkroy@media.mit.edu

Abstract

The ability to infer persona from dialogue
can have applications in areas ranging from
computational narrative analysis to personal-
ized dialogue generation. We introduce neu-
ral models to learn persona embeddings in a
supervised character trope classification task.
The models encode dialogue snippets from
IMDB into representations that can capture the
various categories of film characters. The best-
performing models use a multi-level attention
mechanism over a set of utterances. We also
utilize prior knowledge in the form of tex-
tual descriptions of the different tropes. We
apply the learned embeddings to find similar
characters across different movies, and clus-
ter movies according to the distribution of the
embeddings. The use of short conversational
text as input, and the ability to learn from
prior knowledge using memory, suggests these
methods could be applied to other domains.

1 Introduction

Individual personality plays a deep and pervasive
role in shaping social life. Research indicates that
it can relate to the professional and personal rela-
tionships we develop (Barrick and Mount, 1993),
(Shaver and Brennan, 1992), the technological in-
terfaces we prefer (Nass and Lee, 2000), the be-
havior we exhibit on social media networks (Self-
hout et al., 2010), and the political stances we take
(Jost et al., 2009).

With increasing advances in human-machine di-
alogue systems, and widespread use of social me-
dia in which people express themselves via short
text messages, there is growing interest in systems
that have an ability to understand different person-
ality types. Automated personality analysis based
on short text analysis could open up a range of po-
tential applications, such as dialogue agents that

∗The first two authors contributed equally to this work.

sense personality in order to generate more inter-
esting and varied conversations.

We define persona as a person’s social role,
which can be categorized according to their con-
versations, beliefs, and actions. To learn personas,
we start with the character tropes data provided in
the CMU Movie Summary Corpus by (Bamman
et al., 2014). It consists of 72 manually identified
commonly occurring character archetypes and ex-
amples of each. In the character trope classifica-
tion task, we predict the character trope based on
a batch of dialogue snippets.

In their original work, the authors use
Wikipedia plot summaries to learn latent variable
models that provide a clustering from words to
topics and topics to personas – their persona clus-
terings were then evaluated by measuring similar-
ity to the ground-truth character trope clusters. We
asked the question – could personas also be in-
ferred through dialogue? Because we use quotes
as a primary input and not plot summaries, we be-
lieve our model is extensible to areas such as dia-
logue generation and conversational analysis.

Our contributions are:

1. Data collection of IMDB quotes and charac-
ter trope descriptions for characters from the
CMU Movie Summary Corpus.

2. Models that greatly outperform the baseline
model in the character trope classification
task. Our experiments show the importance
of multi-level attention over words in dia-
logue, and over a set of dialogue snippets.

3. We also examine how prior knowledge in
the form of textual descriptions of the per-
sona categories may be used. We find that a
‘Knowledge-Store’ memory initialized with
descriptions of the tropes is particularly use-
ful. This ability may allow these models to be
used more flexibly in new domains and with



2639

Character Trope Character Movie
Corrupt corporate executive Les Grossman Tropic Thunder

Retired outlaw Butch Cassidy Butch Cassidy and the Sundance Kid
Lovable rogue Wolverine X-Men

Table 1: Example tropes and characters

different persona categories.

2 Related Work

Prior to data-driven approaches, personalities were
largely measured by asking people questions and
assigning traits according to some fixed set of di-
mensions, such as the Big Five traits of openness,
conscientiousness, extraversion, agreeability, and
neuroticism (Tupes and Christal, 1992). Compu-
tational approaches have since advanced to infer
these personalities based on observable behaviors
such as the actions people take and the language
they use (Golbeck et al., 2011).

Our work builds on recent advances in neural
networks that have been used for natural language
processing tasks such as reading comprehension
(Sukhbaatar et al., 2015) and dialogue modeling
and generation (Vinyals and Le, 2015; Li et al.,
2016; Shang et al., 2015). This includes the grow-
ing literature in attention mechanisms and mem-
ory networks (Bahdanau et al., 2014; Sukhbaatar
et al., 2015; Kumar et al., 2016).

The ability to infer and model personality has
applications in storytelling agents, dialogue sys-
tems, and psychometric analysis. In particular,
personality-infused agents can help “chit-chat”
bots avoid repetitive and uninteresting utterances
(Walker et al., 1997; Mairesse and Walker, 2007;
Li et al., 2016; Zhang et al., 2018). The more
recent neural models do so by conditioning on a
‘persona’ embedding – our model could help pro-
duce those embeddings.

Finally, in the field of literary analysis, graphi-
cal models have been proposed for learning char-
acter personas in novels (Flekova and Gurevych,
2015; Srivastava et al., 2016), folktales (Valls-
Vargas et al., 2014), and movies (Bamman et al.,
2014). However, these models often use more
structured inputs than dialogue to learn personas.

3 Datasets

Characters in movies can often be categorized into
archetypal roles and personalities. To understand
the relationship between dialogue and personas,

we utilized three different datasets for our mod-
els: (a) the Movie Character Trope dataset, (b)
the IMDB Dialogue Dataset, and (c) the Charac-
ter Trope Description Dataset. We collected the
IMDB Dialogue and Trope Description datasets,
and these datasets are made publicly available 1.

3.1 Character Tropes Dataset

The CMU Movie Summary dataset provides
tropes commonly occurring in stories and media
(Bamman et al., 2014). There are a total of 72
tropes, which span 433 characters and 384 movies.
Each trope contains between 1 and 25 characters,
with a median of 6 characters per trope. Tropes
and canonical examples are shown in Table 1.

3.2 IMDB Dialogue Snippet Dataset

To obtain the utterances spoken by the charac-
ters, we crawled the IMDB Quotes page for each
movie. Though not every single utterance spoken
by the character may be available, as the quotes
are submitted by IMDB users, many quotes from
most of the characters are typically found, espe-
cially for the famous characters found in the Char-
acter Tropes dataset. The distribution of quotes
per trope is displayed in Figure 1. Our models
were trained on 13,874 quotes and validated and
tested on a set of 1,734 quotes each.

We refer to each IMDB quote as a (contextu-
alized) dialogue snippet, as each quote can con-
tain several lines between multiple characters, as
well as italicized text giving context to what might
be happening when the quote took place. Fig-
ure 2 show a typical dialogue snippet. 70.3% of
the quotes are multi-turn exchanges, with a mean
of 3.34 turns per multi-turn exchange. While the
character’s own lines alone can be highly indica-
tive of the trope, our models show that account-
ing for context and the other characters’ lines and
context improves performance. The context, for
instance, can give clues to typical scenes and ac-
tions that are associated with certain tropes, while
the other characters’ lines give further detail into

1https://pralav.github.io/emnlp_
personas/

https://pralav.github.io/emnlp_personas/
https://pralav.github.io/emnlp_personas/


2640

cl
a
ss

y
_c

a
t_

b
u
rg

la
r

th
e
_c

h
ie

f
p
u
p
il_

tu
rn

e
d
_t

o
_e

v
il

b
u
lly

se
lf
_m

a
d
e
_m

a
n

o
p
h
e
lia

a
b
se

n
t_

m
in

d
e
d
_p

ro
fe

ss
o
r

d
e
a
n
_b

it
te

rm
a
n

th
e
_e

d
it

o
r

ju
n
ki

e
_p

ro
p
h
e
t

ro
m

a
n
ti

c_
ru

n
n
e
ru

p
d
u
m

b
_m

u
sc

le
b
ro

ke
n
_b

ir
d

cr
a
zy

_s
u
rv

iv
a
lis

t

kl
u
tz

y
o
u
n
g
_g

u
n

e
v
il_

p
ri

n
ce

st
o
ry

te
lle

r
ch

a
n
te

u
se

d
ir

ty
_c

o
p

g
ra

n
o
la

_p
e
rs

o
n

e
g
o
m

a
n
ia

c_
h
u
n
te

r
h
e
n
p
e
ck

e
d
_h

u
sb

a
n
d

o
ff

ic
e
r_

a
n
d
_a

_g
e
n
tl

e
m

a
n

d
ri

ll_
sa

rg
e
a
n
t_

n
a
st

y
st

u
p
id

_c
ro

o
ks

fi
n
a
l_

g
ir

l

d
o
o
rm

a
t

m
o
ra

lly
_b

a
n
kr

u
p
t_

b
a
n
ke

r
e
cc

e
n
tr

ic
_m

e
n
to

r
p
la

y
fu

l_
h
a
ck

e
r

je
rk

_j
o
ck

co
n
su

m
m

a
te

_p
ro

fe
ss

io
n
a
l

b
ig

_m
a
n
_o

n
_c

a
m

p
u
s

g
ru

m
p
y
_o

ld
_m

a
n

b
ra

in
le

ss
_b

e
a
u
ty

lo
se

r_
p
ro

ta
g
o
n
is

t
ch

ild
_p

ro
d
ig

y
w

a
rr

io
r_

p
o
e
t

re
ti

re
d
_o

u
tl

a
w

d
it

z
h
it

m
a
n
_w

it
h
_a

_h
e
a
rt

p
sy

ch
o
_f

o
r_

h
ir

e
fa

st
e
st

_g
u
n
_i

n
_t

h
e
_w

e
st

a
rr

o
g
a
n
t_

ku
n
g
fu

_g
u
y

p
ri

m
a
_d

o
n
n
a

v
a
lle

y
_g

ir
l

g
e
n
tl

e
m

a
n
_t

h
ie

f
b
o
u
n
ty

_h
u
n
te

r
fa

th
e
r_

to
_h

is
_m

e
n

re
v
e
n
g
e

tr
a
n
q
u
il_

fu
ry

co
rr

u
p
t_

co
rp

o
ra

te
_e

x
e
cu

ti
v
e

su
rf

e
r_

d
u
d
e

b
ru

is
e
r_

w
it

h
_a

_s
o
ft

_c
e
n
te

r
d
u
m

b
_b

lo
n
d
e

m
a
st

e
r_

sw
o
rd

sm
a
n

h
a
rd

b
o
ile

d
_d

e
te

ct
iv

e

ca
sa

n
o
v
a

g
a
d
g
e
te

e
r_

g
e
n
iu

s
b
ro

m
a
n
ti

c_
fo

il

co
w

a
rd

h
e
a
rt

b
ro

ke
n
_b

a
d
a
ss

a
d
v
e
n
tu

re
r_

a
rc

h
a
e
o
lo

g
is

t
cu

lt
u
re

d
_b

a
d
a
ss

cr
a
zy

_j
e
a
lo

u
s_

g
u
y

lo
v
e
a
b
le

_r
o
g
u
e

tr
ic

ks
te

r
st

o
n
e
r

ch
a
rm

e
r

sl
a
ck

e
r

b
y
ro

n
ic

_h
e
ro

0

200

400

600

800

1000

1200

1400

1600

1800

Figure 1: Number of IMDB dialogue snippets per trope

Figure 2: Example IMDB dialogue snippet containing mul-
tiple characters and context.

the relationship between the character and his or
her environment.

3.3 Character Trope Description Dataset

We also incorporate descriptions of each of the
character tropes by using the corresponding de-
scriptions scraped from TVTropes2. Each descrip-
tion contains several paragraphs describing typical
characteristics, actions, personalities, etc. about
the trope. As we demonstrate in our experiments,
the use of these descriptions improves classifica-
tion performance. This could allow our model to
be applied more flexibly beyond the movie char-
acter tropes – as one example, we could store de-
scriptions of personalities based on the Big Five
traits in our Knowledge-Store memory.

4 Problem Formulation

Our goal is to train a model that can take a batch
of dialogue snippets from the IMDB dataset and
predict the character trope.

Formally, let NP be the total number of char-
acter tropes in the character tropes dataset. Each
character C is associated with a correspond-
ing ground-truth trope category P . Let S =
(D,E,O) be a dialog snippet associated with
a character C, where D = [wD1 , wD2 ..., wDT ]
refers to the character’s own lines, E =

2http://tvtropes.org

[wE1 , wE2 ..., wET ] is the contextual information
and O = [wO1 , wO2 ..., wOT ] denotes the other
characters’ lines. We define all three components
of S to have fixed sequence length T and pad when
necessary. Let NS be the total number of dialogue
snippets for a trope. We sample a set of Ndiag
(where Ndiag � NS) snippets from NS snippets
related to the trope as inputs to our model.

5 Attentive Memory Network

The Attentive Memory Network consists of two
major components: (a) Attentive Encoders, and
(b) a Knowledge-Store Memory Module. Figure 3
outlines the overall model. We describe the com-
ponents in the following sections.

5.1 Attentive Encoders

Not every piece of dialogue may be reflective
of a latent persona. In order to learn to ignore
words and dialogue snippets that are not informa-
tive about the trope we use a multi-level attentive
encoder that operates at (a) the individual snippet
level, and (b) across multiple snippets.

Attentive Snippet Encoder

The snippet encoder extracts features from a sin-
gle dialogue snippet S, with attention over the
words in the snippet. A snippet S = (D,E,O)
is fed to the encoder to extract features from each
of these textual inputs and encode them into an
embedding space. We use a recurrent neural net-
work as our encoder, explained in detail in Sec-
tion 5.1.1. In order to capture the trope-reflective
words from the input text, we augment our model
with a self-attention layer which scores each word
in the given text for its relevance. Section 5.1.2
explains how the attention weights are computed.
The output of this encoder is an encoded snippet
embedding Se = (De, Ee, Oe).

Attentive Inter-Snippet Encoder

As shown in Figure 3, the Ndiag snippet em-
beddings Se from the snippet encoder are fed to
our inter-snippet encoder. This encoder captures
inter-snippet relationship using recurrence over
the Ndiag snippet embeddings for a given trope
and determines their importance. Some of the di-
alogue snippets may not be informative about the
trope, and the model learns to assign low attention
scores to such snippets. The resulting attended

http://tvtropes.org


2641

Figure 3: Illustration of the Attentive Memory Network. The network takes dialogue snippets as input and predicts its asso-
ciated character trope. In this example, dialogue snippets associated with the character trope “Bruiser with a Soft Corner” is
given as input to the model.

summary vector from this phase is the persona rep-
resentation z, defined as:

z = γsDD
s + γsEE

s + γsOO
s

γsD + γ
s
E + γ

s
O = 1

(1)

where γsD, γ
s
E , γ

s
O are learnable weight parame-

ters. Ds, Es, Os refers to summary vectors of
the Ndiag character’s lines, contextual informa-
tion, and other characters’ lines, respectively. In
Section 7, we experiment with models that have
γsE and γ

s
O set to 0 to understand how the contex-

tual information and other characters’ lines con-
tribute to the overall performance.

5.1.1 Encoder
Given an input sequence (x1, x2, ..., xT ), we use
a recurrent neural network to encode the sequence
into hidden states (h1, h2, ..., hT ). In our exper-
iments, we use a gated recurrent network (GRU)
(Chung et al., 2014) over LSTMs (Hochreiter and
Schmidhuber, 1997) because the latter is more
computationally expensive. We use bidirectional
GRUs and concatenate our forward and backwards
hidden states to get

←→
ht for t = 1, ..., T .

5.1.2 Attention
We define an attention mechanism Attn that com-
putes s from the resultant hidden states

←→
ht of a

GRU by learning to generate weights αt. This can
be interpreted as the relative importance given to a
hidden state ht to form an overall summary vector
for the sequence. Formally, we define it as:

at = fattn(ht) (2)
αt = softmax(at) (3)

s =

T∑
t=1

αtht (4)

where fattn is a two layer fully connected network
in which the first layer projects ht ∈ IRdh to an
attention hidden space gt ∈ IRda , and the second
layer produces a relevance score for every hidden
state at timestep t.

5.2 Memory Modules

Our model consists of a read-only ‘Knowledge-
Store’ memory, and we also test a recent read-
write memory. External memories have been
shown to help on natural language processing
tasks (Sukhbaatar et al., 2015; Kumar et al., 2016;
Kaiser and Nachum, 2017), and we find similar
improvements in learning capability.

5.2.1 Knowledge-Store Memory
The main motivation behind the Knowledge-Store
memory module is to incorporate prior domain
knowledge. In our work, this knowledge refers to
the trope descriptions described in Section 3.3.

Related works have initialized their memory
networks with positional encoding using word em-
beddings (Sukhbaatar et al., 2015; Kumar et al.,
2016; Miller et al., 2016). To incorporate the de-
scriptions, we represent them with skip thought
vectors (Kiros et al., 2015) and use them to ini-
tialize the memory keys KM ∈ IRNP×dK , where
NP is the number of tropes, and dK is set to
the size of embedded trope description RD, i.e.
dK = ||RD||.

The values in the memory represent learnable
embeddings of corresponding trope categories
VM ∈ IRNP×dV , where dV is the size of the
trope category embeddings. The network learns to
use the persona representation z from the encoder
phase to find relevant matches in the memory. This



2642

corresponds to calculating similarities between z
and the keys KM . Formally, this is calculated as:

zM = fz(z) (5)

p
(i)
M = softmax(zM ·KM [i]) (6)

∀i ∈ {1, .., NP }

where fz : IRdh 7→ IRdK is a fully-connected
layer that projects the persona representation in the
space of memory keys KM . Based on the match
probabilities p(i)M , the values VM are weighted and
cumulatively added to the original persona repre-
sentation as:

rout =

NP∑
i=1

p
(i)
M · VM [i] (7)

We iteratively combine our mapped persona
representation zM with information from the
memory rout. The above process is repeated nhop
times. The memory mapped persona representa-
tion zM is updated as follows:

zhopM = fr(z
hop−1
M ) + rout (8)

where z0M = zM , and fr : IR
dV 7→ IRdK is a fully-

connected layer. Finally, we transform the re-
sulting znhopM using another fully-connected layer,
fout ∈ IRdK 7→ IRdh , via:

ẑM = fout(z
nhop
M ) (9)

5.2.2 Read-Write Memory
We also tested a Read-Write Memory following
Kaiser et. al (Kaiser and Nachum, 2017), which
was originally designed to remember rare events.
In our case, these ‘rare’ events might be key di-
alogue snippets that are particularly indicative of
latent persona. It consists of keys, which are ac-
tivations of a specific layer of model, i.e. the
persona representation z, and values, which are
the ground-truth labels, i.e. the trope categories.
Over time, it is able to facilitate predictions based
on past data with similar activations stored in the
memory. For every new example, the network
writes to memory for future look up. A memory
with memory size NM is defined as:

M = (KNM×dH , VNM , ANM ) (10)

Memory Read We use the persona embedding
z as a query to the memory. We calculate the co-
sine similarities between z and the keys inM , take
the softmax on the top-k neighbors, and compute
a weighted embedding ẑM using those scores.

Memory Write We update the memory in a
similar fashion to the original work by (Kaiser and
Nachum, 2017), which takes into account the max-
imum age of items as stored in ANM .

6 Objective Losses

To train our model, we utilize the different objec-
tive losses described below.

6.1 Classification Loss

We calculate the probability of a character belong-
ing to a particular trope category P through Equa-
tion 11, where fP : IRdh 7→ IRNP is a fully-
connected layer, and z is the persona representa-
tion produced by the multi-level attentive encoders
described in Equation 1. We then optimize the cat-
egorical cross-entropy loss between the predicted
and true tropes as in Equation 12, where NP is the
total number of tropes, qj is the predicted distribu-
tion that the input character fulls under trope j, and
pj ∈ {0, 1} denotes the ground-truth of whether
the input snippets come from characters from the
jth trope.

q = softmax(fP (z)) (11)

JCE =

NP∑
j=1

−pj log(qj) (12)

6.2 Trope Description Triplet Loss

In addition to using trope descriptions to initialize
the Knowledge-Store Memory, we also test learn-
ing from the trope descriptions through a triplet
loss (Hoffer and Ailon, 2015). We again use the
skip thought vectors to represent the descriptions.
Specifically, we want to maximize the similarity
of representations obtained from dialogue snippets
with their corresponding description, and mini-
mize their similarity with negative examples. We
implement this as:

RP = fD(z) (13)

JT = max(0, s(R
P , RDn )− s(RP , RDp ) + αT ) (14)

where fD : IRdh 7→ IR||R
D|| is a fully-connected

layer. The triplet ranking loss is then Equation
14, where αT is a learnable margin parameter and
s(·, ·) denotes the similarity between trope em-
beddings (RP ), positive (RDp ) and negative (R

D
n )

trope descriptions.



2643

Trope Description Triplet Loss with Memory
Module
If a memory module is used, we compute a new
triplet loss in place of the one described in Equa-
tion 14. Models that use a memory module
should learn a representation ẑM , based on ei-
ther the prior knowledge stored in the memory
(as in Knowledge-Store memory) or the top-k key
matches (as in Read-Write memory), that is simi-
lar to the representation of the trope descriptions.

This is achieved by replacing the persona em-
bedding z in Equation 13 with the memory out-
put ẑM as shown in Equation 15, where fDM :
IRdh 7→ IR||RD|| is a fully-connected layer. To
compute the new loss, we combine the representa-
tions obtained from Equations 13 and 15 through
a learnable parameter γ that determines the impor-
tance of each representation. Finally, we utilize
this combined representation R̂P to calculate the
loss as shown in Equation 17.

RPM = fDM (ẑM ) (15)

R̂P = γRP + (1− γ)RPM (16)

JMT = max(0, s(R̂
P , RDn )− s(R̂P , RDp ) + αMT ) (17)

6.3 Read-Write Memory Losses

When the Read-Write memory is used, we use two
extra loss functions. The first is a Memory Rank-
ing Loss JMR as done in (Kaiser and Nachum,
2017), which learns based on whether a query with
the persona embedding z returns nearest neighbors
with the correct trope. The second is a Memory
Classification Loss JMCE that uses the values re-
turned by the memory to predict the trope. The
full details for both are found in Supplementary
Section A.

6.4 Overall Loss

We combine the above losses through:

J = βCE · JCE
+ βT · ĴT

+ βMR · JMR + βMCE · JMCE

ĴT =

{
JMT if memory module is used
JT otherwise.

(18)

where β = [βCE , βMCE , , βT , βMR] are learn-
able weights such that

∑
i βi = 1. Depending on

which variant of the model is being used, the list
β is modified to contain only relevant losses. For
example, when the Knowledge-Store memory is
used, we set βMR = βMCE = 0 and β is modified

to β = [βCE , βT ]. We discuss different variants of
our model in the next section.

7 Experiments

We experimented with combinations of our var-
ious modules and losses. The experimental re-
sults and ablation studies are described in the fol-
lowing sections, and the experimental details are
described in Supplementary Section B. The dif-
ferent model permutation names in Table 2, e.g.
“attn 3 tropetrip ks-mem ndialog16”, are defined
as follows:

• baseline vs attn: The ‘baseline’ model uses
only one dialogue snippet S to predict the
trope, i.e. Ndiag = 1. Hence, the inter-
snippet encoder is not used. The ‘attn’ model
operates onNdiag dialogue snippets using the
inter-snippet encoder to assign an attention
score for each snippet Si.
• char vs. 3: To measure the importance of

context and other characters’ lines, we have
two variants – ‘char’ uses only the char-
acter’s lines, while ‘3’ uses the character’s
lines, other character’s lines, and all context
lines. Formally, in ‘char’ mode, we set γsE
and γsO to 0 in Equation 1. In ‘attn’ mode,
(γsE , γ

s
O, γ

s
D) are learned by the model.

• tropetrip: The presence of ’tropetrip’ indi-
cates that the triplet loss on the trope de-
scriptions was used. If ‘-500’ is appended
to ‘tropetrip’, then the 4800-dimensional skip
embeddings representing the descriptions in
Equations 15 and 17 are projected to 500 di-
mensions using a fully connected layer.
• ks-mem vs. rw-mem: ‘ks-mem’ refers to the

Knowledge-Store memory, and ‘rw-mem’
refers to the Read-Write memory.
• ndialog: The number of dialogue snippets
Ndiag used as input for the attention mod-
els. Any attention model without the explicit
Ndiag listed uses Ndiag = 8.

7.1 Ablation Results

Baseline vs. Attention Model. The attention
model shows a large improvement over the base-
line models. This matches our intuition that not
every quote is strongly indicative of character
trope. Some may be largely expository or ‘chit-
chat’ pieces of dialogue. Example attention scores
are shown in Section 7.2.



2644

Model Accuracy Precision Recall F1
baseline char 0.286 0.538 0.286 0.339

baseline 3 0.287 0.552 0.288 0.349
attn char 0.630 0.586 0.628 0.600

attn 3 0.630 0.590 0.630 0.603
attn 3 tropetrip 0.615 0.566 0.615 0.583

attn 3 tropetrip-500 0.644 0.601 0.642 0.615
attn 3 ks-mem 0.678 0.648 0.676 0.657
attn 3 rw-mem 0.635 0.598 0.635 0.611

attn 3 tropetrip ks-mem 0.663 0.628 0.662 0.639
attn 3 tropetrip-500 ks-mem 0.654 0.618 0.652 0.629

attn 3 tropetrip rw-mem 0.649 0.602 0.648 0.617
attn 3 tropetrip-500 rw-mem 0.644 0.608 0.644 0.619

attn 3 tropetrip-500 ks-mem ndialog16 0.740 0.707 0.741 0.718
attn 3 tropetrip-500 ks-mem ndialog32 0.750 0.750 0.750 0.750

attn 3 tropetrip ks-mem ndialog16 0.740 0.722 0.741 0.728
attn 3 tropetrip ks-mem ndialog32 0.731 0.712 0.731 0.718

Table 2: Experimental results. Details and analysis are given in Section 7.1. The best performing results in each block are
bolded. The first block examines the baseline model vs. the attention model, as well as use of different inputs. The second block
uses the triplet loss, and the third block uses our memory modules. The fourth block combines the triplet loss and memory
module, which the fifth block extends to larger Ndiag .

Rumors of my death have been greatly exaggerated.

What does it matter? Nothing's real down there. Our life is here.

I don't give a shit who he's connected to. … I want you vacate this 
guy off the premises, and I want you to exit him off his feet and use 
his head to open the fucking door.

I had to see you. Stacy, I swear... I- I don't blame you for hating 
me. Or for wanting to break up. I just- Let me explain. About my 
family. I ju- I didn't want you to know. See, my dad's a drunk. 
Alright? … Cause when you love somebody, you never give up 
on them.

Not so bad... Oh! 'Ello, beastie.

I heard things.

Fuck! Fuck! That's it, I'm screwed. It's over.

dfasdf

I'm the man.

0.330

0.181

0.155

0.081

0.061

0.055

0.054

0.082

Figure 4: Attention scores for a batch of dialogues for the
“byronic hero” trope 3.

Though our experiments showed marginal im-
provement between using the ‘char’ data and the
‘3’ data, we found that using all 3 inputs had
greater performance for models with the triplet
loss and read-only memory. This is likely because
the others’ lines and context capture more of the
social dynamics and situations that are described
in the trope descriptions. Subsequent results are
shown only for the ‘attn 3’ models.

Trope Description Triplet Loss. Adding the
trope description loss alone provided relatively
small gains in performance, though we see greater
gains when combined with memory. While both
use the descriptions, perhaps the Knowledge Store
memory matches an embedding against all the

3TVtropes.org defines a byronic hero as “Sometimes an
Anti-Hero, others an Anti-Villain, or even Just a Villain, By-
ronic heroes are charismatic characters with strong passions
and ideals, but who are nonetheless deeply flawed individu-
als....”

tropes, whereas the trope triplet loss is only pro-
vided information from one positive and one neg-
ative example.

Memory Modules. The Knowledge-Store
memory in particular was helpful. Initialized with
the trope descriptions, this memory can ‘sharpen’
queries toward one of the tropes. The Read-Write
memory had smaller gains in performance. It may
be that more data is required to take advantage of
the write capabilities.

Combined Trope Description Triplet Loss
and Memory Modules. Using the triplet loss
with memory modules led to greater performance
when compared to the attn 3 model, but the per-
formance sits around the use of either triplet only
or memory only. However, when we increase the
Ndiag to 16 or 32, we find a jump in performance.
This is likely the case because the model has both
increased learning capacity and a larger sample of
data at every batch, which means at least some of
the Ndiag quotes should be informative about the
trope.

7.2 Attention Scores

Because the inter-snippet encoder provides such a
large gain in performance compared to the base-
line model, we provide an example illustrating the
weights placed on a batch of Ndiag snippets. Fig-
ure 4 shows the attention scores for the charac-
ter’s lines in the “byronic hero” trope. Matching
what we might expect for an antihero personality,
we find the top weighted line to be full of confi-
dence and heroic bluster, while the middle lines



2645

hint at the characters’ personal turmoil. We also
find the lowly weighted sixth and seventh lines to
be largely uninformative (e.g. “I heard things.”),
and the last line to be perhaps too pessimistic and
negative for a hero, even a byronic one.

7.3 Purity scores of character clusters
Finally, we measure our ability to recover the trope
‘clusters’ (with one trope being a cluster of its
characters) with our embeddings through the pu-
rity score used in (Bamman et al., 2014). Equa-
tion 19 measures the amount of overlap between
two clusterings, where N is the total number of
characters, gi is the i-ith ground truth cluster, and
cj is the j-th predicted cluster.

Purity =
1

N

∑
i

maxj |gi ∩ cj | (19)

We use a simple agglomerative clustering
method on our embeddings with a parameter k for
the number of clusters. The methods in (Bamman
et al., 2014) contain a similar hyper-parameter for
the number of persona clusters. We note that the
metrics are not completely comparable because
not every character in the original dataset was
found on IMDB. The results are shown in Table
3. It might be expected that our model perform
better because we use the character tropes them-
selves as training data. However, dialogue may be
noisier than the movie summary data; their better
performing Persona Regression (PR) model also
uses useful metadata features such as the movie
genre and character gender. We simply note that
our scores are comparable or higher.

k PR DP AMN
25 42.9 39.63 48.4
50 36.5 31.0 48.1
100 30.3 24.4 45.2

Table 3: Cluster purity scores. k is the number of clusters,
PR and DP are the Persona Regression and Dirichlet Persona
models from (Bamman et al., 2014), and AMN is our atten-
tion memory network.

8 Application: Narrative Analysis

We collected IMDB quotes for the top 250 movies
on IMDB. For every character, we calculated a
character embedding by taking the average em-
bedding produced by passing all the dialogues
through our model. We then calculated movie
embeddings by taking the weighted sum of all
the character embeddings in the movie, with the

weight as the percentage of quotes they had in the
movie. By computing distances between pairs of
character or movie embeddings, we could poten-
tially unearth notable similarities. We note some
of the interesting clusters below.

8.1 Clustering Characters
• Grumpy old men: Carl Fredricksen (Up);

Walk Kowalski (Gran Torino)
• Shady tricksters, crooks, well versed in de-

ceit: Ugarte (Casablanca); Eames (Inception)
• Intrepid heroes, adventurers: Indiana Jones

(Indiana Jones and the Last Crusade); Nemo
(Finding Nemo); Murph (Interstellar)

8.2 Clustering Movies
• Epics, historical tales: Amadeus, Ben-Hur
• Tortured individuals, dark, violent: Donnie

Darko, Taxi Driver, Inception, The Prestige
• Gangsters, excess: Scarface, Goodfellas,

Reservoir Dogs, The Departed, Wolf of Wall
Street

9 Conclusion

We used the character trope classification task as a
test bed for learning personas from dialogue. Our
experiments demonstrate that the use of a multi-
level attention mechanism greatly outperforms a
baseline GRU model. We were also able to lever-
age prior knowledge in the form of textual descrip-
tions of the trope. In particular, using these de-
scriptions to initialize our Knowledge-Store mem-
ory helped improved performance. Because we
use short text and can leverage domain knowl-
edge, we believe future work could use our models
for applications such as personalized dialogue sys-
tems.

References
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Ben-

gio. 2014. Neural machine translation by jointly
learning to align and translate. arXiv preprint
arXiv:1409.0473.

David Bamman, Brendan O’Connor, and Noah A
Smith. 2014. Learning latent personas of film char-
acters. In Proceedings of the Annual Meeting of the
Association for Computational Linguistics (ACL),
page 352.

Murray R Barrick and Michael K Mount. 1993. Au-
tonomy as a moderator of the relationships between
the big five personality dimensions and job perfor-
mance. Journal of applied Psychology, 78(1):111.



2646

Junyoung Chung, Caglar Gulcehre, KyungHyun Cho,
and Yoshua Bengio. 2014. Empirical evaluation of
gated recurrent neural networks on sequence model-
ing. arXiv preprint arXiv:1412.3555.

Lucie Flekova and Iryna Gurevych. 2015. Personal-
ity profiling of fictional characters using sense-level
links between lexical resources. In Proceedings of
the 2015 Conference on Empirical Methods in Nat-
ural Language Processing, pages 1805–1816.

Jennifer Golbeck, Cristina Robles, Michon Edmond-
son, and Karen Turner. 2011. Predicting person-
ality from twitter. In Privacy, Security, Risk and
Trust (PASSAT) and 2011 IEEE Third Inernational
Conference on Social Computing (SocialCom), 2011
IEEE Third International Conference on, pages
149–156. IEEE.

Sepp Hochreiter and Jürgen Schmidhuber. 1997.
Long short-term memory. Neural computation,
9(8):1735–1780.

Elad Hoffer and Nir Ailon. 2015. Deep metric learning
using triplet network. In International Workshop on
Similarity-Based Pattern Recognition, pages 84–92.
Springer.

John T Jost, Tessa V West, and Samuel D Gosling.
2009. Personality and ideology as determinants of
candidate preferences and obama conversion in the
2008 us presidential election. Du Bois Review: So-
cial Science Research on Race, 6(1):103–124.

Łukasz Kaiser and Ofir Nachum. 2017. Aurko roy, and
samy bengio. Learning to remember rare events.
arXiv preprint.

Ryan Kiros, Yukun Zhu, Ruslan R Salakhutdinov,
Richard Zemel, Raquel Urtasun, Antonio Torralba,
and Sanja Fidler. 2015. Skip-thought vectors. In
Advances in neural information processing systems,
pages 3294–3302.

Ankit Kumar, Ozan Irsoy, Peter Ondruska, Mohit
Iyyer, James Bradbury, Ishaan Gulrajani, Victor
Zhong, Romain Paulus, and Richard Socher. 2016.
Ask me anything: Dynamic memory networks for
natural language processing. In International Con-
ference on Machine Learning, pages 1378–1387.

Jiwei Li, Michel Galley, Chris Brockett, Georgios P
Spithourakis, Jianfeng Gao, and Bill Dolan. 2016.
A persona-based neural conversation model. arXiv
preprint arXiv:1603.06155.

François Mairesse and Marilyn Walker. 2007. Person-
age: Personality generation for dialogue. In Pro-
ceedings of the 45th Annual Meeting of the Associa-
tion of Computational Linguistics, pages 496–503.

Alexander Miller, Adam Fisch, Jesse Dodge, Amir-
Hossein Karimi, Antoine Bordes, and Jason We-
ston. 2016. Key-value memory networks for
directly reading documents. arXiv preprint
arXiv:1606.03126.

Clifford Nass and Kwan Min Lee. 2000. Does
computer-generated speech manifest personality?
an experimental test of similarity-attraction. In Pro-
ceedings of the SIGCHI conference on Human Fac-
tors in Computing Systems, pages 329–336. ACM.

Maarten Selfhout, William Burk, Susan Branje, Jaap
Denissen, Marcel Van Aken, and Wim Meeus. 2010.
Emerging late adolescent friendship networks and
big five personality traits: A social network ap-
proach. Journal of personality, 78(2):509–538.

Lifeng Shang, Zhengdong Lu, and Hang Li. 2015.
Neural responding machine for short-text conversa-
tion. arXiv preprint arXiv:1503.02364.

Phillip R Shaver and Kelly A Brennan. 1992. At-
tachment styles and the” big five” personality traits:
Their connections with each other and with romantic
relationship outcomes. Personality and Social Psy-
chology Bulletin, 18(5):536–545.

Shashank Srivastava, Snigdha Chaturvedi, and Tom M
Mitchell. 2016. Inferring interpersonal relations in
narrative summaries. In AAAI, pages 2807–2813.

Sainbayar Sukhbaatar, Jason Weston, Rob Fergus, et al.
2015. End-to-end memory networks. In Advances
in neural information processing systems, pages
2440–2448.

Ernest C Tupes and Raymond E Christal. 1992. Recur-
rent personality factors based on trait ratings. Jour-
nal of personality, 60(2):225–251.

Josep Valls-Vargas, Jichen Zhu, and Santiago Ontanón.
2014. Toward automatic role identification in unan-
notated folk tales. In Tenth Artificial Intelligence
and Interactive Digital Entertainment Conference.

Oriol Vinyals and Quoc Le. 2015. A neural conversa-
tional model. arXiv preprint arXiv:1506.05869.

Marilyn A Walker, Janet E Cahn, and Stephen J Whit-
taker. 1997. Improvising linguistic style: Social and
affective bases for agent personality. In Proceedings
of the first international conference on Autonomous
agents, pages 96–105. ACM.

Saizheng Zhang, Emily Dinan, Jack Urbanek, Arthur
Szlam, Douwe Kiela, and Jason Weston. 2018. Per-
sonalizing dialogue agents: I have a dog, do you
have pets too? arXiv preprint arXiv:1801.07243.


